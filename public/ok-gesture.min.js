const WHEEL_SCALE_SPEEDUP=2,WHEEL_TRANSLATION_SPEEDUP=2,DELTA_LINE_MULTIPLIER=8,DELTA_PAGE_MULTIPLIER=24,MAX_WHEEL_DELTA=24;function limit(e,t){return Math.sign(e)*Math.min(t,Math.abs(e))}function normalizeWheel(e){let t=e.deltaX,n=e.deltaY;return e.shiftKey&&0===t&&([t,n]=[n,t]),e.deltaMode===WheelEvent.DOM_DELTA_LINE?(t*=8,n*=8):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=24,n*=24),[limit(t,24),limit(n,24)]}function midpoint(e){let[t,n]=e;return{x:(t.clientX+n.clientX)/2,y:(t.clientY+n.clientY)/2}}function distance(e){let[t,n]=e;return Math.hypot(n.clientX-t.clientX,n.clientY-t.clientY)}function angle(e){let[t,n]=e,i=n.clientX-t.clientX,a=n.clientY-t.clientY;return 180*Math.atan2(a,i)/Math.PI}function okzoomer(e,t){function n(){}let i,a,o=t||{},l=o.startGesture||n,r=o.doGesture||n,c=o.endGesture||n,s=null;e.addEventListener("wheel",function(e){!1!==e.cancelable&&e.preventDefault();let[t,n]=normalizeWheel(e);if(s||(s={origin:{x:e.clientX,y:e.clientY},scale:1,translation:{x:0,y:0}},l(s)),e.ctrlKey){let t=n<=0?1-2*n/100:1/(1+2*n/100);s={origin:{x:e.clientX,y:e.clientY},scale:s.scale*t,translation:s.translation}}else s={origin:{x:e.clientX,y:e.clientY},scale:s.scale,translation:{x:s.translation.x-2*t,y:s.translation.y-2*n}};r(s),i&&window.clearTimeout(i),i=window.setTimeout(function(){s&&(c(s),s=null)},200)},{passive:!1});let u=null;function E(e){if(2===e.touches.length){let t=midpoint(a),n=midpoint(e.touches);u={scale:void 0!==e.scale?e.scale:distance(e.touches)/distance(a),rotation:void 0!==e.rotation?e.rotation:angle(e.touches)-angle(a),translation:{x:n.x-t.x,y:n.y-t.y},origin:t},r(u),!1!==e.cancelable&&e.preventDefault()}}if(e.addEventListener("touchstart",function t(n){2===n.touches.length?(a=n.touches,u={scale:1,rotation:0,translation:{x:0,y:0},origin:midpoint(a)},"touchstart"===n.type&&!1!==n.cancelable&&n.preventDefault(),l(u),e.addEventListener("touchmove",E,{passive:!1}),e.addEventListener("touchend",t),e.addEventListener("touchcancel",t)):u&&(c(u),u=null,e.removeEventListener("touchmove",E),e.removeEventListener("touchend",t),e.removeEventListener("touchcancel",t))},{passive:!1}),"undefined"!=typeof GestureEvent&&"undefined"==typeof TouchEvent){let t=!1;e.addEventListener("gesturestart",function(e){t||(l({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),t=!0),!1!==e.cancelable&&e.preventDefault()},{passive:!1}),e.addEventListener("gesturechange",function(e){t&&r({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),!1!==e.cancelable&&e.preventDefault()},{passive:!1}),e.addEventListener("gestureend",function(e){t&&(c({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),t=!1)})}}function gestureToMatrix(e,t){return(new DOMMatrix).translate(t.x,t.y).translate(e.translation.x||0,e.translation.y||0).rotate(e.rotation||0).scale(e.scale||1).translate(-t.x,-t.y)}function getOrigin(e,t){if(e instanceof HTMLElement){let n=e.getBoundingClientRect();return{x:t.origin.x-n.x,y:t.origin.y-n.y}}if(e instanceof SVGElement){let n=e.ownerSVGElement.getScreenCTM().inverse();return new DOMPoint(t.origin.x,t.origin.y).matrixTransform(n)}throw new Error("Expected HTML or SVG element")}function applyMatrix(e,t){if(e instanceof HTMLElement)e.style.transform=t;else{if(!(e instanceof SVGElement))throw new Error("Expected HTML or SVG element");e.setAttribute("transform",t)}}export{okzoomer,gestureToMatrix,getOrigin,applyMatrix};