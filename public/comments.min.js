import{timeago}from"./utils.min.js?v=ThK8FQxJ";import{replaceRedditLinks,htmlDecode}from"./html.min.js?v=ThK8FQxJ";import{getget}from"./functions.min.js?v=ThK8FQxJ";export function cbuilder(e){let t=timeago(1e3*e.created_utc),a=1==e.is_submitter?"isop":"",i=" moderator"==e.distinguished?"ismod":"",r=htmlDecode(e.body_html),d=null;if(e.media_metadata){d="";for(let t in e.media_metadata){let a=e.media_metadata[t];if(0===a?.m?.indexOf("image")&&a?.s?.u){let e='<a href="'+a.s.u+'">'+a.s.u+"</a>";r.indexOf(e)&&(r=r.replace(e,'<img style="max-width:'+a.s.x+'px" class="comment-image" src="'+a.s.u+'" />'))}}}else if(0===e.body.indexOf("https://youtu.be")){var l=e.body.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);l&&11==l[7].length&&(d='<div class="video-frame-wrapper"><iframe class="comment-video" frameborder="0" src="https://www.youtube.com/embed/'+l[7]+'"></iframe></div>')}d&&(r=d);let o='<div class="comment ccp'+e.depth+("AutoModerator"===e.author?" collapsed":"")+'" id="'+e.id+'"><div class="comment_author"><span class="authorttext '+a+i+'"><a class="authorlink" href="user.html?u='+e.author+'">'+e.author+'</a></span>  <span class="comment_meta upvotes-icon icon">'+e.score+" &bull; "+t+' </span></div><div class="comment_text">'+replaceRedditLinks(r)+"</div>";return o+="</div>",o}export function loadcomments(e){var t='<div class="comments-block">';const a=document.getElementById("paginate");a.childNodes.forEach((e=>e.remove())),a.dataset.cids="";for(let i in e)if("more"==e[i].kind&&e[i].data.children.length){let t=e[i].data.children;a.innerHTML='<button class="load-more-comments">Load More</button>',a.dataset.cids=t}else{t+=cbuilder(e[i].data);let a=e[i].data.replies;"object"==typeof a&&null!==a&&(t+=handlereplies(a))}return t+="</div>"}function handlerepliesmn(e){var t="";let a=e.data.children;for(let e in a)if("more"==a[e].kind)t+='<div class="comment ccp'+a[e].data.depth+'"><div class="comment_author"><a href="?url=https://www.reddit.com'+a[e].data.permalink+' " >View other replies</a></div></div>';else{t+=cbuilder(a[e].data);var i=a[e].data.replies;"object"==typeof i&&null!==i&&(t+='<a class="viewmore" href="?url=https://www.reddit.com'+a[e].data.permalink+'" >view more replies</a>')}return t}function handlerepliesm(e){let t=e.data.children;var a="";for(let e in t)if("more"==t[e].kind)a+='<div class="comment ccp'+t[e].data.depth+'"><div class="comment_author"><a href="?url=https://www.reddit.com'+t[e].data.permalink+' " >View other replies</a></div></div>';else{a+=cbuilder(t[e].data);var i=t[e].data.replies;"object"==typeof i&&null!==i&&(a+=handlerepliesmn(i))}return a}function handlereplies(e){let t=e.data.children;var a="";for(let e in t)if("more"==t[e].kind){a+='<a class="viewmore" href="?url='+getget("url")+t[e].data.id+'/">View more replies</a>'}else{a+=cbuilder(t[e].data);var i=t[e].data.replies;"object"==typeof i&&null!==i&&(a+=handlerepliesm(i))}return a}