import{getget,setTitle,makereq,postbuilder,postsLoadedCallback,collapseComment}from"./functions.min.js?v=KvbkyM8T";import{loadcomments,cbuilder}from"./comments.min.js";var thisthread,pagenum=0;function loadmore(e){if(e){for(var t="",r=60*pagenum;r<e.length;r++)if(t+=e[r]+",",r>60*(pagenum+1)){pagenum+=1;break}var n=new XMLHttpRequest;n.responseType="json",t=t.replace(/,\s*$/,""),n.open("GET","https://www.reddit.com/r/"+thisthread.subreddit+"/api/morechildren.json?api_type=json&&link_id="+thisthread.name+"&limit=500&r=AskReddit&children="+t,!0),n.onload=function(){var e=n.response.json.data.things;document.getElementById("body").innerHTML+=loadcomments(e)},n.send(null)}}function opencmenu(e){cidi=document.getElementById(e).getAttribute("menushown"),"yes"==cidi?(document.getElementById(e+"cc").remove(),document.getElementById(e).setAttribute("menushown","no"),console.log("yy")):(htmltoc='<div class="cmenu" id="'+e+'cc"><a onclick="">Save</a></div>',document.getElementById(e).insertAdjacentHTML("afterBegin",htmltoc),document.getElementById(e).setAttribute("menushown","yes"))}document.addEventListener("click",(e=>{e.target.classList.contains("load-more-comments")&&(e.preventDefault(),loadmore(document.getElementById("paginate").dataset.cids.split(" ")))}));export function saveItem(e){if("Saved"==e.innerHTML)return window.location.href="saved.html",!1;const t=window.location.href,r=document.title,n=document.querySelector(".post_author a").innerText,o=JSON.parse(localStorage.getItem("savedlinks"))||[];o.push({u:t,t:r,s:n}),localStorage.setItem("savedlinks",JSON.stringify(o)),e.innerHTML="Saved"}document.addEventListener("click",(e=>{"savebutton"===e.target.id&&(e.preventDefault(),saveItem(e.target))})),document.body.classList.add("comments");var url=getget("url"),roqs=url.split("?");url=roqs[0],roqs=roqs[1];var links='<a href="comments.html?url='+(url=(url=(url=(url=url.replace(/https:\/\/reddit.com/g,"https://www.reddit.com")).replace(/amp.reddit.com/g,"www.reddit.com")).replace(/m.reddit.com/g,"www.reddit.com")).replace(/i.reddit.com/g,"www.reddit.com"))+'&sort=new">New</a><a href="comments.html?url='+url+'&sort=best">Best</a><a href="comments.html?url='+url+'&sort=top">Top</a><a href="comments.html?url='+url+'&sort=controversial">Controversial</a><a href="comments.html?url='+url+'&sort=old">Old</a><a href="comments.html?url='+url+'&sort=qa">QnA</a><a href="#" id="savebutton" style="border-top: 5px solid var(--greyc); cursor:pointer">Save</a>';document.getElementById("rightbar").innerHTML=links,url+=".json?limit=500",null!=getget("sort")&&(url=url+"&sort="+getget("sort")),url=url+"&"+roqs;var req=new XMLHttpRequest;req.responseType="json",req.open("GET",url,!0),req.onload=function(){var e=req.response;thisthread=e[0].data.children[0].data,document.getElementById("body").innerHTML+=postbuilder(thisthread),document.getElementById("pagetitletext").innerHTML=thisthread.subreddit,setTitle(thisthread.title);var t=e[1].data.children;document.getElementById("body").innerHTML+=loadcomments(t);let r=document.getElementById("body").getElementsByClassName("comment");for(let e=0;e<r.length;e++)r[e].addEventListener("dblclick",(e=>{collapseComment(e.target.closest(".comment"))}));postsLoadedCallback(!0)},req.send(null);